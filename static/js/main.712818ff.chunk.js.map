{"version":3,"sources":["features/common/localstorage/index.js","pages/home/model.js","ui/atoms/input.js","ui/atoms/title.js","ui/atoms/listItem.js","ui/atoms/list.js","ui/atoms/label.js","ui/atoms/form.js","ui/atoms/header.js","ui/atoms/text.js","ui/atoms/button.js","ui/atoms/spinner.js","ui/atoms/body.js","ui/atoms/section.js","ui/molecules/search.js","pages/home/page.js","App.js","index.js"],"names":["root","createDomain","onCreateStore","store","snapshot","localStorage","getItem","shortName","setState","JSON","parse","isFirstSkiped","watch","newState","setItem","stringify","createEvent","event","createEffect","effect","createStore","deleteItem","fetching","handler","city","a","async","url","fetch","req","json","refetchWeather","st","$cityNames","name","on","done","state","result","params","cod","find","item","toLowerCase","push","index","filter","_","i","$cityList","oldValue","indexOf","temperature","main","temp","toFixed","feels","feels_like","weather","toUpperCase","id","getState","length","addValue","$inputValue","e","currentTarget","value","reset","Input","styled","input","H1","h1","ListItem","li","List","ul","Label","label","Form","form","Header","header","Text","div","Button","button","spin","keyframes","Spinner","body","Section","section","Search","submiter","placeholder","type","changer","onSubmit","onChange","HomePage","useStore","names","React","useEffect","timer","setInterval","console","log","clearInterval","className","SpinnerContainer","spinner","preventDefault","CityList","useList","listItem","description","parseInt","onClick","createComponent","pending","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.712818ff.chunk.js","sourcesContent":["import {createDomain}  from \"effector\";\r\n\r\nconst root = createDomain(\"root\");\r\n\r\nroot.onCreateStore(store => {\r\n  const snapshot = localStorage.getItem(store.shortName);\r\n  if (snapshot !== null) store.setState(JSON.parse(snapshot));\r\n\r\n  let isFirstSkiped = false;\r\n  store.watch(newState => {\r\n    if (isFirstSkiped) {\r\n      localStorage.setItem(store.shortName, JSON.stringify(newState));\r\n    }\r\n    isFirstSkiped = true;\r\n  });\r\n  return store;\r\n});\r\n\r\nexport const createEvent = root.event;\r\nexport const createEffect = root.effect;\r\nexport const createStore = root.store;","import {createStore, createEvent, createEffect} from '../../features/common'\r\nexport const addCity = createEvent('add city')\r\nexport const deleteItem = createEvent('delete city')\r\n\r\nexport const fetching = createEffect({\r\n  handler: async (city) => {\r\n    const url = `https://api.openweathermap.org/data/2.5/weather?APPID=a82f5bd7cf235d2d97cf411fd97a845d&units=metric&lang=ru&q=${city}`\r\n    const req = await fetch(url)\r\n    return req.json()\r\n  },\r\n})\r\nexport const refetchWeather = createEffect({\r\n    handler: async (store) => {\r\n      for (let st of store) {\r\n       await fetching(st)\r\n      }\r\n   }\r\n  }) \r\nexport const $cityNames = createStore([\"Москва\"], {name: 'cityNames'})\r\n  .on(fetching.done, (state, {result, params}) => {\r\n    if (result.cod === 200) {\r\n      state =[...state]\r\n    const oldValue =state.find(item=> item.toLowerCase() === params.toLowerCase())\r\n    if (oldValue) return       \r\n    else {\r\n        state.push(params)\r\n      }\r\n       return state\r\n    } else return       \r\n    }   \r\n  )  \r\n  .on(deleteItem,(state, index)=> state.filter((_, i)=>i!==index))\r\n\r\nexport const $cityList = createStore(\r\n  [\r\n], {name: 'cityList'})\r\n  .on(deleteItem,(state, index)=> state.filter((_, i)=>i!==index))\r\n  .on(fetching.done, (state, {result, params}) => {\r\n    state = [...state]\r\n    const oldValue = state.find(item => item.name.toLowerCase() === params.toLowerCase())\r\n    if(oldValue) {     \r\n        state[state.indexOf(oldValue)] = {...oldValue, temperature: result.main.temp.toFixed(), feels:result.main.feels_like.toFixed(),\r\n        weather: result.weather}      \r\n    } else {\r\n       state.push({name: params.toUpperCase(), weather: result.weather, temperature: result.main.temp, cod: result.cod, id: result.id,\r\n       feels: result.main.feels_like})\r\n    }\r\n    return state\r\n  })\r\n $cityList.getState().length < 1 && fetching('МОСКВА')\r\n export const addValue = createEvent('add input value')\r\n\r\n export const $inputValue = createStore(\"\")\r\n   .on(addValue, (_, e)=>  e.currentTarget.value)\r\n   .reset(fetching)","import styled from 'styled-components'\r\n\r\nexport const Input = styled.input`\r\n  width: 20rem;\r\n  height: 2rem;\r\n  background-color: lightgray;\r\n  border-radius: 3px;\r\n  border: none;\r\n  color: black;\r\n  margin-left: 10px;\r\n  padding-left:18px;\r\n  ::placeholder {    \r\n    font-size: 17px;\r\n    width: 100%;\r\n    color: black;  \r\n  }\r\n`","import styled from 'styled-components'\r\n \r\nexport const H1 = styled.h1`\r\n  width: 100%;\r\n  height: 30%;\r\n  color: white;\r\n  font-size: 4rem;\r\n  text-align: center;\r\n  @media (max-width: 768px) {\r\n    width: 80%;\r\n    position: relative;\r\n    left: 5%;\r\n    top:50%;      \r\n    font-size: 2rem;\r\n  }\r\n`","import styled from 'styled-components'\r\n\r\nexport const ListItem = styled.li`\r\n  display: grid;\r\n  grid-template-columns: 1fr 120px;\r\n  color: #fff;\r\n  font-size: 17px;\r\n  width: 98%;\r\n`","import styled from 'styled-components'\r\n\r\nexport const List = styled.ul`\r\n  height: 100%;\r\n  list-style: none;  \r\n`","import styled from 'styled-components';\r\n\r\nexport const Label = styled.label`\r\n  padding-left: 20px;\r\n  font-size: 25px;\r\n  color: #fff;\r\n`","import styled from 'styled-components';\r\n\r\nexport const Form = styled.form`\r\n  \r\n`","import styled from 'styled-components';\r\n\r\nexport const Header = styled.header`\r\n  height: 150px;\r\n  margin-top: -43px;\r\n  background: linear-gradient(to right, #2c3e50, #3498db);\r\n  @media (max-width: 768px) {\r\n    position: relative;\r\n    height: 250px;\r\n  }\r\n`","import styled from 'styled-components';\r\n\r\nexport const Text = styled.div`\r\n  text-align:center;\r\n  color: #fff;\r\n  font-size: 36px;\r\n`","import styled from 'styled-components';\r\n\r\nexport const Button = styled.button`\r\n  border-style: none;\r\n  outline: none;\r\n  width: 120px;\r\n  height: 30px;\r\n  border-radius: 10px;\r\n  background-color: green;\r\n  color: #fff;\r\n  :hover {\r\n    opacity: 0.9;\r\n  }\r\n  :active {\r\n    background-color: red;\r\n  }\r\n`","import styled, {keyframes} from 'styled-components'\r\n\r\nconst spin = keyframes`\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }  \r\n`\r\n\r\nexport const Spinner = styled.div`  \r\n  display: block;\r\n  background-color: green;\r\n  color: #fff;\r\n  margin-left: 355px;\r\n  font-size: 16px;\r\n  width: 280px;\r\n  height: 20px;\r\n  text-align: center;\r\n  border-radius: 5px;\r\n  @media (max-width: 768px) {\r\n    width: 100%;\r\n    margin-left: 0;\r\n    background-color: none;\r\n  }\r\n\r\n    ::after {\r\n      content: \" \";\r\n      display: block;\r\n      width: 64px;\r\n      height: 64px;\r\n      margin: 8px;\r\n      margin-top: -30px;\r\n      margin-left: 300px;\r\n      border-radius: 50%;\r\n      border: 6px solid #fff;\r\n      border-color: yellow transparent yellow transparent;\r\n      animation: 1.2s ${spin} linear infinite;\r\n}\r\n`\r\n","import styled from 'styled-components'\r\n\r\nexport const Body = styled.body`\r\n`","import styled from 'styled-components'\r\n\r\nexport const Section = styled.section`\r\n  min-height: 740px;\r\n  background: linear-gradient(to right, #2c3e50, #4ca1af);\r\n`","import React from 'react'\r\n\r\nimport {Form, Input, Label } from '../atoms'\r\n\r\nexport const Search = ({submiter, value, placeholder,type, changer,label}) => {\r\n  return (\r\n<Form onSubmit={submiter}>\r\n  <Label>{label}</Label>\r\n  <Input type={type} value={value} placeholder={placeholder} onChange={changer}/>\r\n</Form>\r\n)\r\n}\r\n\r\n","import React from 'react';\r\nimport { useStore, useList, createComponent} from 'effector-react';\r\nimport {\r\n  $cityList, $cityNames, fetching,\r\n  deleteItem, refetchWeather, $inputValue, addValue\r\n} from './model'\r\nimport { Header, H1, Text, Spinner, Section, List, ListItem, Button } from '../../ui';\r\nimport { Search } from '../../ui'\r\nexport const HomePage = () => {\r\n  const value = useStore($inputValue)\r\n  const names = useStore($cityNames)\r\n  React.useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      console.log('This will run after 1 minute!')\r\n      refetchWeather(names)\r\n    }, 60000);\r\n    return () => clearInterval(timer);\r\n  }, [names]);\r\n\r\n  const handler = (e) => {\r\n    e.preventDefault()\r\n    fetching(value)\r\n  }\r\n  return (\r\n    <>\r\n      <Header className=\"App-header\">\r\n        <H1>Классное погодное приложение</H1>\r\n        <SpinnerContainer spinner={Spinner}></SpinnerContainer>\r\n      </Header>\r\n      <Section>\r\n        <Search value={useStore($inputValue)} \r\n        changer={addValue} type='text'\r\n         placeholder='Например: Нижний Новгород'\r\n          submiter={handler} label='Введите название города' />\r\n        {useStore($cityList).length > 0 ? <CityList /> : <Text>Добавьте город</Text>}\r\n      </Section>\r\n    </>\r\n  );\r\n}\r\nconst CityList = () => useList($cityList, ({ name, weather, temperature, cod, feels }, index) => {\r\n  const listItem =\r\n    cod === 200 ? <ListItem>\r\n      В городе {name} в данный момент {weather[0].description}, температура воздуха\r\n      составляет {parseInt(temperature)} &#176;\r\n      по цельсию, чувствуется как {parseInt(feels)}&#176;\r\n      по цельсию<Button type='button' onClick={() => {\r\n        deleteItem(index)\r\n      }}>Удалить</Button>\r\n    </ListItem> : null\r\n  return <List>{listItem}</List>\r\n})\r\nconst SpinnerContainer = createComponent(fetching.pending, (_, pending) => (\r\n  pending ? <Spinner>Идёт загрузка, пожалуйста, подождите</Spinner> : null\r\n))\r\n","import React from 'react'\r\nimport { Normalize } from \"styled-normalize\"\r\nimport {HomePage} from './pages'\r\nfunction App() {\r\n  return (\r\n    <>\r\n      <Normalize />\r\n      <HomePage/>\r\n    </>\r\n  )\r\n}\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}